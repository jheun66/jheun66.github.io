<!DOCTYPE html>

<html>

<head>

  <meta charset="utf-8">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <title>
    Get data from the internet - In progress
    
  </title>

  <meta name="description" content="개요">

  <link href='https://fonts.googleapis.com/css?family=Lora:400,700,400italic,700italic' rel='stylesheet' type='text/css'>
  <link href='https://fonts.googleapis.com/css?family=Open+Sans:300italic,400italic,600italic,700italic,800italic,400,300,600,700,800' rel='stylesheet' type='text/css'>

  <script src="https://use.fontawesome.com/releases/v5.15.3/js/all.js" crossorigin="anonymous"></script>
  
  <link rel="stylesheet" href="/assets/highlight.css">
  <link rel="stylesheet" href="/assets/main.css">
  <link rel="canonical" href="https://jheun66.github.io/posts/practice/get-data-from-the-internet/">
  <link rel="alternate" type="application/rss+xml" title="In progress" href="/feed.xml">

  <link href="https://unpkg.com/material-components-web@latest/dist/material-components-web.min.css" rel="stylesheet">
<script src="https://unpkg.com/material-components-web@latest/dist/material-components-web.min.js"></script>
<link rel="stylesheet" href="https://fonts.googleapis.com/icon?family=Material+Icons">

<!-- <script type="module">
// const textField = new mdc.textField.MDCTextField(document.querySelector('.mdc-text-field'));
for (const tf of document.querySelectorAll('.mdc-text-field')) {
    new mdc.textField.MDCTextField.attachTo(tf);
}
for (const list of document.querySelectorAll('.mdc-list')) {
    new mdc.list.MDCList.attachTo(list);
}
</script> -->

  <style type="text/css">
    a.comment-link:link {text-decoration: none; color:rgb(170, 170, 170)} 
    a.comment-link:visited {text-decoration: none; color:rgb(170, 170, 170)} 
    a.comment-link:hover {text-decoration: underline;}
  </style>
  <!-- Begin Jekyll SEO tag v2.8.0 -->
<title>Get data from the internet | In progress</title>
<meta name="generator" content="Jekyll v4.2.2" />
<meta property="og:title" content="Get data from the internet" />
<meta name="author" content="Eun JongHyeok" />
<meta property="og:locale" content="en_US" />
<meta name="description" content="개요" />
<meta property="og:description" content="개요" />
<link rel="canonical" href="https://jheun66.github.io/posts/practice/get-data-from-the-internet/" />
<meta property="og:url" content="https://jheun66.github.io/posts/practice/get-data-from-the-internet/" />
<meta property="og:site_name" content="In progress" />
<meta property="og:type" content="article" />
<meta property="article:published_time" content="2021-09-26T13:45:00+00:00" />
<meta name="twitter:card" content="summary" />
<meta property="twitter:title" content="Get data from the internet" />
<meta name="google-site-verification" content="tbEwkoz_olC5QjXqaH3xRQX19VegCM80JTKhBa3iSx8" />
<script type="application/ld+json">
{"@context":"https://schema.org","@type":"BlogPosting","author":{"@type":"Person","name":"Eun JongHyeok"},"dateModified":"2021-09-26T13:45:00+00:00","datePublished":"2021-09-26T13:45:00+00:00","description":"개요","headline":"Get data from the internet","mainEntityOfPage":{"@type":"WebPage","@id":"https://jheun66.github.io/posts/practice/get-data-from-the-internet/"},"url":"https://jheun66.github.io/posts/practice/get-data-from-the-internet/"}</script>
<!-- End Jekyll SEO tag -->


  <script async src="https://pagead2.googlesyndication.com/pagead/js/adsbygoogle.js?client=ca-pub-8954355499146518"
     crossorigin="anonymous"></script>
  <script async src="https://fundingchoicesmessages.google.com/i/pub-8954355499146518?ers=1" nonce="vIYNAgythFLTbocmvIWE6A"></script><script nonce="vIYNAgythFLTbocmvIWE6A">(function() {function signalGooglefcPresent() {if (!window.frames['googlefcPresent']) {if (document.body) {const iframe = document.createElement('iframe'); iframe.style = 'width: 0; height: 0; border: none; z-index: -1000; left: -1000px; top: -1000px;'; iframe.style.display = 'none'; iframe.name = 'googlefcPresent'; document.body.appendChild(iframe);} else {setTimeout(signalGooglefcPresent, 0);}}}signalGooglefcPresent();})();</script>
</head>


<body>

  <!-- Navigation -->
<nav class="navbar navbar-expand-lg navbar-light fixed-top" id="mainNav">
  <div class="container">
    <a class="navbar-brand" href="/">In progress</a>
    <button class="navbar-toggler navbar-toggler-right" type="button" data-toggle="collapse" data-target="#navbarResponsive" aria-controls="navbarResponsive" aria-expanded="false" aria-label="Toggle navigation">
      Menu
      <i class="fa fa-bars"></i>
    </button>
    <div class="collapse navbar-collapse" id="navbarResponsive">
      <ul class="navbar-nav ml-auto">
        <li class="nav-item">
          <a class="nav-link" href="/">Home</a>
        </li>
        <li class="nav-item">
          <a class="nav-link" href="/about">About</a>
        </li>
        <li class="nav-item">
          <a class="nav-link" href="/category">Category</a>
        </li>
        <li class="nav-item">
          <a class="nav-link" href="/contact">Contact</a>
        </li>
      </ul>
    </div>
  </div>
</nav>


  <!-- Page Header -->



<header class="masthead" style="background-color: #34a0a4;">

  <div class="overlay"></div>
  <div class="container">
    <div class="row">
      <div class="col-lg-8 col-md-10 mx-auto">
        <div class="post-heading">
          <h1>Get data from the internet</h1>
          
          <span class="meta">Posted by Eun JongHyeok on September 26, 2021
          </span>
        </div>
      </div>
    </div>
  </div>
</header>

<div class="container">
  <div class="row min-vh-100 flex-column flex-lg-row">
    <div class="col-lg-8 col-md-10 mx-auto">
  
      <ol id="toc" class="table-of-contents">
<li class="toc-entry toc-h1"><a href="#개요">개요</a></li>
<li class="toc-entry toc-h1"><a href="#web-services-and-retrofit">Web services and Retrofit</a>
<ol class="table-of-contents-sublist-class">
<li class="toc-entry toc-h2"><a href="#web-service-request">Web service request</a></li>
<li class="toc-entry toc-h2"><a href="#add-retrofit-dependencies">Add Retrofit dependencies</a></li>
<li class="toc-entry toc-h2"><a href="#add-support-for-java-8-language-features">Add support for Java 8 language features</a></li>
</ol>
</li>
<li class="toc-entry toc-h1"><a href="#connecting-to-the-internet">Connecting to the Internet</a>
<ol class="table-of-contents-sublist-class">
<li class="toc-entry toc-h2"><a href="#object-declarations">Object declarations</a></li>
<li class="toc-entry toc-h2"><a href="#viewmodelscope">ViewModelScope</a></li>
</ol>
</li>
<li class="toc-entry toc-h1"><a href="#add-internet-permission-and-exception-handling">Add Internet permission and Exception Handling</a>
<ol class="table-of-contents-sublist-class">
<li class="toc-entry toc-h2"><a href="#android-permissions">Android Permissions</a></li>
<li class="toc-entry toc-h2"><a href="#exception-handling">Exception Handling</a></li>
</ol>
</li>
<li class="toc-entry toc-h1"><a href="#parse-the-json-response-with-moshi">Parse the JSON response with Moshi</a>
<ol class="table-of-contents-sublist-class">
<li class="toc-entry toc-h2"><a href="#json">JSON</a></li>
<li class="toc-entry toc-h2"><a href="#add-moshi-library-dependencies">Add Moshi library dependencies</a></li>
<li class="toc-entry toc-h2"><a href="#implement-the-mars-photos-data-class">Implement the Mars Photos data class</a></li>
</ol>
</li>
<li class="toc-entry toc-h1"><a href="#learn-more">Learn more</a></li>
</ol><h1 id="개요">
<a class="anchor" href="#%EA%B0%9C%EC%9A%94" aria-hidden="true"><span class="octicon octicon-link"></span></a>개요</h1>

<p>이 글은 <a href="https://developer.android.com/courses/pathways/android-basics-kotlin-unit-4-pathway-2#codelab-https://developer.android.com/codelabs/basic-android-kotlin-training-getting-data-internet">안드로이드 개발자 사이트의 내용</a>을 따라해보면서 작성하였습니다.</p>

<h1 id="web-services-and-retrofit">
<a class="anchor" href="#web-services-and-retrofit" aria-hidden="true"><span class="octicon octicon-link"></span></a>Web services and Retrofit</h1>

<p>오늘날 대부분의 웹 서버는 stateless한 REST(<strong>RE</strong>presentational <strong>S</strong>tate <strong>T</strong>ransfer)라는 웹 아키텍처를 사용하여 서비스됨. 이런 아키텍처를 사용하는 웹 서비스를 RESTful한 서비스라 함.</p>

<p><code class="language-plaintext highlighter-rouge">stateless</code>는 말그대로 상태가 없다란 의미로 서버에서 세션과 같은 상태를 저장하고 있지않는다는 의미.</p>

<p>RESTful한 웹 서비스의 요청은 URI를 통한 정형화된 방법으로 만들어짐. URI(<strong>U</strong>niform <strong>R</strong>esource <strong>I</strong>dentifier)는 서버의 리소스를 위치나 접근하는 법을 함축하지 않고 이름으로 구분함.</p>

<p>URL(<strong>U</strong>niform <strong>R</strong>esource <strong>L</strong>ocator)은 리소스 표현을 획득하거나 이 표현을 통해 무엇을 할지 지정하는 URI. 즉, 기본 액세스 메커니즘과 네트워크 위치를 모두 지정.</p>

<p>따라하는 CodeLab의 예시에서는</p>

<p><a href="https://android-kotlin-fun-mars-server.appspot.com/realestate">https://android-kotlin-fun-mars-server.appspot.com/realestate</a></p>

<p><a href="https://android-kotlin-fun-mars-server.appspot.com/photos">https://android-kotlin-fun-mars-server.appspot.com/photos</a></p>

<p>두 URL이 realestate와 photos를 통해 무슨 리소스인지 구분되고 HTTPS를 통해 획득되는 것을 알 수 있음.</p>

<h2 id="web-service-request">
<a class="anchor" href="#web-service-request" aria-hidden="true"><span class="octicon octicon-link"></span></a>Web service request</h2>

<p>HTTP 동작에는 일반적으로 GET, POST, PUT, Delete가 있고 응답을 받을 때는 XML이나 JSON 형태로 받음.</p>

<h3 id="retrofit-library">Retrofit Library</h3>

<p>예제는 Retrofit이라는 외부 라이브러리를 사용하여 웹 서버와 통신. 외부라이브러리 사용에는 주의를 해야함. 실제 동작은 외부라이브러리를 통해서 실행되므로 의도치 않은 오류가 나올 수 도 있음.</p>

<h2 id="add-retrofit-dependencies">
<a class="anchor" href="#add-retrofit-dependencies" aria-hidden="true"><span class="octicon octicon-link"></span></a>Add Retrofit dependencies</h2>

<p>프로젝트 레벨의 <code class="language-plaintext highlighter-rouge">build.gradle</code>에서는</p>

<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>allprojects{
    repositories{
        google()
        jcenter()
    }
}
</code></pre></div></div>

<p>앱 레벨 <code class="language-plaintext highlighter-rouge">build.gradle</code>에서는</p>

<div class="language-kotlin highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="c1">// Retrofit</span>
<span class="n">implementation</span> <span class="s">"com.squareup.retrofit2:retrofit:2.9.0"</span>
<span class="c1">// Retrofit with Moshi Converter</span>
<span class="n">implementation</span> <span class="s">"com.squareup.retrofit2:converter-scalars:2.9.0"</span>
</code></pre></div></div>

<p>을 추가해주고 Sync Now.</p>

<h2 id="add-support-for-java-8-language-features">
<a class="anchor" href="#add-support-for-java-8-language-features" aria-hidden="true"><span class="octicon octicon-link"></span></a>Add support for Java 8 language features</h2>

<div class="language-kotlin highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="nf">android</span> <span class="p">{</span>
    <span class="o">..</span><span class="p">.</span>

    <span class="nf">compileOptions</span> <span class="p">{</span>
        <span class="n">sourceCompatibility</span> <span class="nc">JavaVersion</span><span class="p">.</span><span class="nc">VERSION_1_8</span>
        <span class="n">targetCompatibility</span> <span class="nc">JavaVersion</span><span class="p">.</span><span class="nc">VERSION_1_8</span>
    <span class="p">}</span>

    <span class="nf">kotlinOptions</span> <span class="p">{</span>
        <span class="n">jvmTarget</span> <span class="p">=</span> <span class="err">'</span><span class="mf">1.8</span><span class="err">'</span>
    <span class="p">}</span>
<span class="p">}</span>
</code></pre></div></div>

<p>많은 외부 라이브러리들이 Java 8을 사용하므로 추가가 필요함.</p>

<h1 id="connecting-to-the-internet">
<a class="anchor" href="#connecting-to-the-internet" aria-hidden="true"><span class="octicon octicon-link"></span></a>Connecting to the Internet</h1>

<p>Retrofit은 웹 서비스로 받은 내용을 기반으로 앱의 네트위트 API를 만들어줌. 웹서버를 통해 데이터를 받아오고 별도의 분리된 Converter 라이브러리를 통해 데이터를 String과 같은 객체 형태로 변환해서 반환함. XML과 JSON과 같은 유명한 데이터 형태를 지원함.</p>

<div class="language-kotlin highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="k">private</span> <span class="kd">val</span> <span class="py">retrofit</span> <span class="p">=</span> <span class="nc">Retrofit</span><span class="p">.</span><span class="nc">Builder</span><span class="p">()</span>
    <span class="p">.</span><span class="nf">addConverterFactory</span><span class="p">(</span><span class="nc">ScalarsConverterFactory</span><span class="p">.</span><span class="nf">create</span><span class="p">())</span>
    <span class="p">.</span><span class="nf">baseUrl</span><span class="p">(</span><span class="nc">BASE_URL</span><span class="p">)</span>
    <span class="p">.</span><span class="nf">build</span><span class="p">()</span>
</code></pre></div></div>

<p>Retrofit 객체 선언.</p>

<h2 id="object-declarations">
<a class="anchor" href="#object-declarations" aria-hidden="true"><span class="octicon octicon-link"></span></a>Object declarations</h2>

<p>object 키워드 선언은 싱글턴 객체를 선언하기 위해 사용됨. Object 선언의 초기화는 thread-safe하고 처음 접근할 때 수행됨.  <a href="https://kotlinlang.org/docs/object-declarations.html">object 표현식과 선언</a> 참고하기.</p>

<div class="language-kotlin highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="kd">object</span> <span class="nc">MarsApi</span> <span class="p">{</span>
    <span class="kd">val</span> <span class="py">retrofitService</span> <span class="p">:</span> <span class="nc">MarsApiService</span> <span class="k">by</span> <span class="nf">lazy</span> <span class="p">{</span> 
       <span class="n">retrofit</span><span class="p">.</span><span class="nf">create</span><span class="p">(</span><span class="nc">MarsApiService</span><span class="o">::</span><span class="k">class</span><span class="p">.</span><span class="n">java</span><span class="p">)</span> <span class="p">}</span>
<span class="p">}</span>
</code></pre></div></div>

<p>by lazy를 통해 객체 생성을 미룬 것을 확인 할 수 있음.</p>

<h2 id="viewmodelscope">
<a class="anchor" href="#viewmodelscope" aria-hidden="true"><span class="octicon octicon-link"></span></a>ViewModelScope</h2>

<p><a href="https://developer.android.com/topic/libraries/architecture/coroutines#viewmodelscope">ViewModelScope</a>는 앱에서 각각의 ViewModel을 위해 정의된 코루틴 스코프. 이 스코프에 있는 Coroutine은 ViewModel이 지워지면 자동으로 취소됨.</p>

<div class="language-kotlin highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="kd">interface</span> <span class="nc">MarsApiService</span> <span class="p">{</span>
    <span class="nd">@GET</span><span class="p">(</span><span class="s">"photos"</span><span class="p">)</span>
    <span class="k">suspend</span> <span class="k">fun</span> <span class="nf">getPhotos</span><span class="p">()</span> <span class="p">:</span> <span class="nc">String</span>
<span class="p">}</span>
</code></pre></div></div>

<div class="language-kotlin highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="k">private</span> <span class="k">fun</span> <span class="nf">getMarsPhotos</span><span class="p">()</span> <span class="p">{</span>
    <span class="n">viewModelScope</span><span class="p">.</span><span class="nf">launch</span> <span class="p">{</span>
        <span class="kd">val</span> <span class="py">listResult</span> <span class="p">=</span> <span class="nc">MarsApi</span><span class="p">.</span><span class="n">retrofitService</span><span class="p">.</span><span class="nf">getPhotos</span><span class="p">()</span>
        <span class="n">_status</span><span class="p">.</span><span class="n">value</span> <span class="p">=</span> <span class="n">listResult</span>
    <span class="p">}</span>
<span class="p">}</span>
</code></pre></div></div>

<p>getPhotos()는 코루틴 내에서 동작하는 함수이므로 <code class="language-plaintext highlighter-rouge">suspend</code> 키워드를 붙여줌.</p>

<h1 id="add-internet-permission-and-exception-handling">
<a class="anchor" href="#add-internet-permission-and-exception-handling" aria-hidden="true"><span class="octicon octicon-link"></span></a>Add Internet permission and Exception Handling</h1>

<h2 id="android-permissions">
<a class="anchor" href="#android-permissions" aria-hidden="true"><span class="octicon octicon-link"></span></a>Android Permissions</h2>

<p>Permission의 역활은 안드로이드 유저의 프라이버시를 보호. 안드로이드 앱은 연락처, 전화 기록과 같은 민감한 유저 정보에 접근하거나 카메라, 인터넷 같은 시스템 기능을 획득하기 위해서는 permission을 선언하거나 요청해야함.</p>

<p>인터넷 사용 permission은 다음과 같이 선언하여 얻을 수 있음</p>

<div class="language-xml highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="nt">&lt;uses-permission</span> <span class="na">android:name=</span><span class="s">"android.permission.INTERNET"</span> <span class="nt">/&gt;</span>
</code></pre></div></div>

<h2 id="exception-handling">
<a class="anchor" href="#exception-handling" aria-hidden="true"><span class="octicon octicon-link"></span></a>Exception Handling</h2>

<p>Exception은 런타임에 발생하고 유저에게 알려주지 않고 갑자기 종료되는 에러. user experience 관점에서 매우 안좋음. 갑자기 종료되는 것을 막기위해서는 예외처리가 필요함.</p>

<p>try-catch 블록을 사용하여 예외에 대한 핸들링을 해줄 수 있음.</p>

<h1 id="parse-the-json-response-with-moshi">
<a class="anchor" href="#parse-the-json-response-with-moshi" aria-hidden="true"><span class="octicon octicon-link"></span></a>Parse the JSON response with Moshi</h1>

<h2 id="json">
<a class="anchor" href="#json" aria-hidden="true"><span class="octicon octicon-link"></span></a>JSON</h2>

<p>요청된 데이터는 일반적으로 XML이나 JSON 포맷으로 구성.</p>

<p><a href="https://android-kotlin-fun-mars-server.appspot.com/photos">https://android-kotlin-fun-mars-server.appspot.com/photos</a></p>

<p>예제의 URL을 크롬과 같은 웹브라우저에서 요청해보면 JSON으로 응답이 오는 것을 확인할 수 있음</p>

<p>예제에서는 JSON을 코틀린 객체로 변환하기 위해 Moshi 라는 외부라이브러리를 사용.Retrofit은 Moshi와 함께 동작하는 converter를 가지고 있어서 Retrofit과 사용하기 좋은 라이브러리.</p>

<h2 id="add-moshi-library-dependencies">
<a class="anchor" href="#add-moshi-library-dependencies" aria-hidden="true"><span class="octicon octicon-link"></span></a>Add Moshi library dependencies</h2>

<div class="language-kotlin highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="c1">// Moshi</span>
<span class="n">implementation</span> <span class="err">'</span><span class="n">com</span><span class="p">.</span><span class="n">squareup</span><span class="p">.</span><span class="n">moshi</span><span class="p">:</span><span class="n">moshi-kotlin</span><span class="p">:</span><span class="mf">1.9.3</span><span class="err">'</span>
<span class="c1">// Retrofit with Moshi Converter</span>
<span class="n">implementation</span> <span class="err">'</span><span class="n">com</span><span class="p">.</span><span class="n">squareup</span><span class="p">.</span><span class="n">retrofit2</span><span class="p">:</span><span class="n">converter-moshi</span><span class="p">:</span><span class="mf">2.9.0</span><span class="err">'</span>
</code></pre></div></div>

<p>추가하기</p>

<div class="language-kotlin highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="c1">// Retrofit</span>
<span class="n">implementation</span> <span class="s">"com.squareup.retrofit2:retrofit:2.9.0"</span>
</code></pre></div></div>

<p>converter-moshi 내부에 포함되어 있으므로 제거</p>

<h2 id="implement-the-mars-photos-data-class">
<a class="anchor" href="#implement-the-mars-photos-data-class" aria-hidden="true"><span class="octicon octicon-link"></span></a>Implement the Mars Photos data class</h2>

<p>Moshi를 통해 JSON 응답 형태를 코틀린 객체로 만들기 위한 클래스 추가</p>

<div class="language-kotlin highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="kd">data class</span> <span class="nc">MarsPhoto</span><span class="p">(</span>
    <span class="kd">val</span> <span class="py">id</span><span class="p">:</span> <span class="nc">String</span><span class="p">,</span> <span class="kd">val</span> <span class="py">img_src</span><span class="p">:</span> <span class="nc">String</span>
<span class="p">)</span>
</code></pre></div></div>

<p>data 키워드를 사용하여 클래스를 만들고 JSON 응답에 있는 이름으로 프로퍼티를 선언해줌</p>

<h3 id="json-annotation">@Json Annotation</h3>

<div class="language-kotlin highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="kd">data class</span> <span class="nc">MarsPhoto</span> <span class="p">(</span>
    <span class="kd">val</span> <span class="py">id</span><span class="p">:</span> <span class="nc">String</span><span class="p">,</span>
    <span class="nd">@Json</span><span class="p">(</span><span class="n">name</span> <span class="p">=</span> <span class="s">"img_src"</span><span class="p">)</span> <span class="kd">val</span> <span class="py">imgSrcUrl</span><span class="p">:</span> <span class="nc">String</span> <span class="p">=</span> <span class="s">""</span>
<span class="p">)</span>
</code></pre></div></div>

<p>img_src는 코틀린 프로퍼티에 사용하는 코딩스타일이 아니므로 Json annotation을 사용하여 낙타표기법으로 바꿔줌.</p>

<div class="language-kotlin highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="k">private</span> <span class="n">valmoshi</span><span class="p">=</span> <span class="nc">Moshi</span><span class="p">.</span><span class="nc">Builder</span><span class="p">()</span>
    <span class="p">.</span><span class="nf">add</span><span class="p">(</span><span class="nc">KotlinJsonAdapterFactory</span><span class="p">())</span>
    <span class="p">.</span><span class="nf">build</span><span class="p">()</span>

<span class="k">private</span> <span class="n">valretrofit</span><span class="p">=</span> <span class="nc">Retrofit</span><span class="p">.</span><span class="nc">Builder</span><span class="p">()</span>
    <span class="p">.</span><span class="nf">addConverterFactory</span><span class="p">(</span><span class="nc">MoshiConverterFactory</span><span class="p">.</span><span class="nf">create</span><span class="p">(</span><span class="n">moshi</span><span class="p">))</span>
    <span class="p">.</span><span class="nf">baseUrl</span><span class="p">(</span><span class="nc">BASE_URL</span><span class="p">)</span>
    <span class="p">.</span><span class="nf">build</span><span class="p">()</span>

<span class="kd">interface</span> <span class="nc">MarsApiService</span> <span class="p">{</span>
    <span class="nd">@GET</span><span class="p">(</span><span class="s">"photos"</span><span class="p">)</span>
    <span class="k">suspend</span> <span class="k">fun</span> <span class="nf">getPhotos</span><span class="p">():</span> <span class="nc">List</span><span class="p">&lt;</span><span class="nc">MarsPhoto</span><span class="p">&gt;</span>
<span class="p">}</span>
</code></pre></div></div>

<p>MoshiConverter를 통해 JSON이 코틀린 객체로 변환되는 것을 확인할 수 있음.</p>

<h1 id="learn-more">
<a class="anchor" href="#learn-more" aria-hidden="true"><span class="octicon octicon-link"></span></a><strong>Learn more</strong>
</h1>

<p>추가 공부해야할 링크들</p>

<p>Android developer documentation:</p>

<ul>
  <li><a href="https://developer.android.com/topic/libraries/architecture/viewmodel">ViewModel Overview</a></li>
  <li><a href="https://developer.android.com/topic/libraries/architecture/livedata#kotlin">LiveData Overview</a></li>
  <li><a href="https://developer.android.com/reference/android/arch/lifecycle/MutableLiveData">MutableLiveData</a></li>
  <li><a href="https://developer.android.com/topic/libraries/architecture/coroutines#viewmodelscope">ViewModelScope</a></li>
</ul>

<p>Kotlin documentation:</p>

<ul>
  <li><a href="https://kotlinlang.org/docs/reference/exceptions.html">Exceptions: try, catch, finally, throw, Nothing</a></li>
  <li><a href="https://codelabs.developers.google.com/codelabs/kotlin-coroutines/">Coroutines codelab</a></li>
  <li><a href="https://kotlinlang.org/docs/reference/coroutines-overview.html">Coroutines, official documentation</a></li>
  <li><a href="https://kotlinlang.org/docs/reference/coroutines/coroutine-context-and-dispatchers.html">Coroutine context and dispatchers</a></li>
</ul>

<p>Other:</p>

<ul>
  <li><a href="https://square.github.io/retrofit/">Retrofit</a></li>
  <li><a href="https://github.com/square/moshi">Moshi</a></li>
  <li><a href="https://proandroiddev.com/moshi-with-retrofit-in-kotlin-%EF%B8%8F-a69c2621708b">Moshi with Retrofit in Kotlin</a></li>
</ul>


      <hr>
      
      
        <div class="tag-class"><i class="fa fa-tag"></i>Tutorial</div>
      
      
        <div class="tag-class"><i class="fa fa-tag"></i>Retrofit</div>
      
      
        <div class="tag-class"><i class="fa fa-tag"></i>JSON</div>
      
      
        <div class="tag-class"><i class="fa fa-tag"></i>Moshi</div>
      
      
        <div class="tag-class"><i class="fa fa-tag"></i>Internet</div>
      
      
        <div class="tag-class"><i class="fa fa-tag"></i>Permissions</div>
      

      <hr>

      <!-- 다음 포스트, 이전 포스트 카테고리별로 정리 -->
      

      
      

      
      <a class="btn btn-primary float-left" href="/posts/practice/introduction-to-coroutines/" data-toggle="tooltip" data-placement="top" title="Introduction to coroutines">&larr; Previous<span class="d-none d-md-inline">
          Post</span></a>
      
      
      <a class="btn btn-primary float-right" href="/posts/practice/load-and-display-images-from-the-internet/" data-toggle="tooltip" data-placement="top" title="Load and display images from the Internet">Next<span class="d-none d-md-inline">
          Post</span> &rarr;</a>
      

      
      <div id="disqus_thread"></div>
      <script>
          /**
          *  RECOMMENDED CONFIGURATION VARIABLES: EDIT AND UNCOMMENT THE SECTION BELOW TO INSERT DYNAMIC VALUES FROM YOUR PLATFORM OR CMS.
          *  LEARN WHY DEFINING THESE VARIABLES IS IMPORTANT: https://disqus.com/admin/universalcode/#configuration-variables    */
          
          var disqus_config = function () {
          this.page.url = 'https://jheun66.github.io/posts/practice/get-data-from-the-internet/';  // Replace PAGE_URL with your page's canonical URL variable
          this.page.identifier = '/posts/practice/get-data-from-the-internet/'; // Replace PAGE_IDENTIFIER with your page's unique identifier variable
          };
          
          (function() { // DON'T EDIT BELOW THIS LINE
          var d = document, s = d.createElement('script');
          s.src = 'https://jheun66.disqus.com/embed.js';
          s.setAttribute('data-timestamp', +new Date());
          (d.head || d.body).appendChild(s);
          })();
      </script>
      <noscript>Please enable JavaScript to view the <a href="https://disqus.com/?ref_noscript">comments powered by Disqus.</a></noscript>
      

    </div>
  </div>
</div>


  <!-- Footer -->

<hr>

<footer>
  <div class="container">
    <div class="row">
      <div class="col-lg-8 col-md-10 mx-auto">
        <ul class="list-inline text-center">
          
          <li class="list-inline-item">
            <a href="mailto:jheun5@naver.com">
              <span class="fa-stack fa-lg">
                <i class="fas fa-circle fa-stack-2x"></i>
                <i class="far fa-envelope fa-stack-1x fa-inverse"></i>
              </span>
            </a>
          </li>
          
          
          <li class="list-inline-item">
            <a href="https://twitter.com/amos55606241">
              <span class="fa-stack fa-lg">
                <i class="fas fa-circle fa-stack-2x"></i>
                <i class="fab fa-twitter fa-stack-1x fa-inverse"></i>
              </span>
            </a>
          </li>
          
          
          <li class="list-inline-item">
            <a href="https://www.facebook.com/amos.eun.73">
              <span class="fa-stack fa-lg">
                <i class="fas fa-circle fa-stack-2x"></i>
                <i class="fab fa-facebook-f fa-stack-1x fa-inverse"></i>
              </span>
            </a>
          </li>
          
          
          
          <li class="list-inline-item">
            <a href="https://github.com/jheun66">
              <span class="fa-stack fa-lg">
                <i class="fas fa-circle fa-stack-2x"></i>
                <i class="fab fa-github fa-stack-1x fa-inverse"></i>
              </span>
            </a>
          </li>
          
          
          <li class="list-inline-item">
            <a href="https://instagram.com/jheun66">
              <span class="fa-stack fa-lg">
                <i class="fas fa-circle fa-stack-2x"></i>
                <i class="fab fa-instagram fa-stack-1x fa-inverse"></i>
              </span>
            </a>
          </li>
          
        </ul>
        <p class="copyright text-muted">Copyright &copy; Eun JongHyeok 2024</p>
      </div>
    </div>
  </div>
</footer>


  <script src="https://code.jquery.com/jquery-3.5.1.min.js"></script>
<script src="https://cdn.jsdelivr.net/npm/bootstrap@4.6.0/dist/js/bootstrap.bundle.min.js"></script>
<script src="/assets/vendor/startbootstrap-clean-blog/js/scripts.js"></script>

<script src="/assets/scripts.js"></script>




  <!-- Global site tag (gtag.js) - Google Analytics -->
<script async src="https://www.googletagmanager.com/gtag/js?id=G-T1H0RYSGS7"></script>
<script>
  window.dataLayer = window.dataLayer || [];
  function gtag(){dataLayer.push(arguments);}
  gtag('js', new Date());

  gtag('config', 'G-T1H0RYSGS7');
</script>



  <style>
.videoWrapper {
    position: relative;
    padding-bottom: 56.333%;
    height: 0;
    background: black;
}
.videoWrapper iframe {
    position: absolute;
    top: 0;
    left: 0;
    width: 100%;
    height: 100%;
    border: 0;
}    
</style>

<script>
function get_youtube_id(url) {
    var p = /^(?:https?:\/\/)?(?:www\.)?(?:youtu\.be\/|youtube\.com\/(?:embed\/|v\/|watch\?v=|watch\?.+&v=))((\w|-){11})(?:\S+)?$/;
    return (url.match(p)) ? RegExp.$1 : false;
}
function vimeo_embed(url,el) {
    var id = false;
    $.ajax({
        url: 'https://vimeo.com/api/oembed.json?url='+url,
        async: true,
        success: function(response) {
        if(response.video_id) {
            id = response.video_id;
            if(url.indexOf('autoplay=1') !== -1) var autoplay=1; else var autoplay=0;
            if(url.indexOf('loop=1') !== -1) var loop=1; else var loop=0;
            var theInnerHTML = '<div class="videoWrapper"><iframe src="https://player.vimeo.com/video/'+id+'/?byline=0&title=0&portrait=0';
            if(autoplay==1) theInnerHTML += '&autoplay=1';
            if(loop==1) theInnerHTML += '&loop=1';
            theInnerHTML += '" webkitallowfullscreen mozallowfullscreen allowfullscreen></iframe></div>'; 
            el.innerHTML = theInnerHTML;
        }
        }
    });
}
function video_embed() {
    var p = document.getElementsByTagName('p');
    for(var i = 0; i < p.length; i++) {
        //check if this is an external url (that starts with https:// or http://
        if (p[i].innerHTML.indexOf("http://") == 0 ||
            p[i].innerHTML.indexOf("https://") == 0) {
            var youtube_id = get_youtube_id(p[i].innerHTML);
            if(youtube_id) {
                if(p[i].innerHTML.indexOf('autoplay=1') !== -1) var autoplay=1; else var autoplay=0;
                if(p[i].innerHTML.indexOf('loop=1') !== -1) var loop=1; else var loop=0;
                var theInnerHTML = '<div class="videoWrapper"><iframe width="720" height="420" src="https://www.youtube.com/embed/' + youtube_id + '?rel=0&showinfo=0';
                if(autoplay==1) theInnerHTML += '&autoplay=1';
                if(loop==1) theInnerHTML += '&loop=1&playlist='+youtube_id+'&version=3';
                if(p[i].innerHTML.indexOf('start=') !== -1) theInnerHTML += '&start='+p[i].innerHTML.substring(p[i].innerHTML.indexOf('start=')+6);
                theInnerHTML += '" frameborder="0" allowfullscreen></iframe></div>';
                p[i].innerHTML = theInnerHTML;
            }
            if(p[i].innerHTML.indexOf('vimeo.com') !== -1) {
                //ask vimeo for the id and place the embed
                vimeo_embed(p[i].innerHTML,p[i]);
            }
        }
    }
}
video_embed();

function mp3_embed() {
    var p = document.getElementsByTagName('p');
    for(var i = 0; i < p.length; i++) {
        if(p[i].innerHTML.indexOf('.mp3') !== -1) {
            var str = p[i].innerHTML.split('?');
            if(str.length == 1) str[1] = '';
            var str1 = str[1];
            str1 = str1.replace('&','').replace('&','');
            str1 = str1.replace('autoplay=1','').replace('autoplay=0','');
            str1 = str1.replace('loop=1','').replace('loop=0','');
            str1 = str1.replace('controls=0','').replace('controls=1','');

            if (str[0].lastIndexOf('.mp3', str[0].length - 4) === str[0].length - 4 && str1.length == 0) {
                if(str[1].indexOf('autoplay=1') !== -1) var autoplay=1; else var autoplay=0;
                if(str[1].indexOf('loop=1') !== -1) var loop=1; else var loop=0;
                if(str[1].indexOf('controls=0') !== -1) var controls=0; else var controls=1;
                var newInnerHTML = '<audio';
                if(autoplay==1) newInnerHTML += ' autoplay';
                if(loop==1) newInnerHTML += ' loop';
                if(controls==1) newInnerHTML += ' controls';
                newInnerHTML += '><source src="'+str[0]+'" type="audio/mpeg">Your browser does not support the audio element.</audio>';
                p[i].innerHTML = newInnerHTML;
            }
        }
    }
}
mp3_embed();
</script>
  
  <script id="dsq-count-scr" src="//jheun66.disqus.com/count.js" async></script>
  
</body>

</html>
